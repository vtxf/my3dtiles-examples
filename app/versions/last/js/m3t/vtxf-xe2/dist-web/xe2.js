/*! For license information please see xe2.js.LICENSE.txt */
var XE2;(()=>{"use strict";var e={58753:(e,t,n)=>{var r;Object.defineProperty(t,"__esModule",{value:!0}),t.copyright=void 0;var o=null!==(r="".concat("vtxf-xe2","/").concat(n.j))&&void 0!==r?r:"-",i="vtxf-xe2",c=((Date.now()-1736155021e3)/36e5).toFixed(1),a="%c🌏 ".concat(o,"%c ").concat("0.2.58",".").concat("92f6e6f9ed2c86ba37aa7d302d05db0d00918393".slice(0,8),".").concat("2025-01-06T09:17:01.000Z"," (距今").concat(c,"个小时)\n%c").concat(i?i+"\n":"","当前网站正在使用").concat(o,"，此软件版权归").concat("beijing jinfei technology co.,ltd","所有\n");t.copyright=Object.seal({get owner(){return"beijing jinfei technology co.,ltd"},get ownerlink(){return""},get gituri(){return""},get info(){return a},get date(){return"2025-01-06T09:17:01.000Z"},get author(){return"vtxf"},get version(){return"0.2.58"},get name(){return"vtxf-xe2"},get commitId(){return"92f6e6f9ed2c86ba37aa7d302d05db0d00918393"},print:function(e){void 0===e&&(e=!1),!e&&window._xe2_no_copy_print||console.info(this.info,"\n            font-size: 18px;\n            font-weight: 1000;\n            line-height: 1;\n            color: rgb(0, 120, 215);\n            padding-top: 20px;\n            padding-bottom: 10px;\n            ","\n            font-size: 10px;\n            font-weight: 1000;\n            color: rgb(0, 120, 215);\n            ","\n            font-size: 10px;\n            line-height: 1.5;\n            color: rgb(0, 120, 215);\n            padding-bottom: 2px;\n            padding-left: 35px;\n            ")}}),window.g_xe2CopyRights=window.g_xe2CopyRights||{},window.g_xe2CopyRights[o]=t.copyright},83746:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DoWithAllowPickingOnCreating=void 0;var i=n(80468),c=n(51355),a=function(e){function t(t,n){var r=e.call(this)||this;return r._projectManager=n,"pickedEvent"in t&&r._projectManager.allowPickingOnCreating&&Reflect.has(t,"allowPicking")&&(t.allowPicking=!0),r}return o(t,e),t}(c.Destroyable),s=function(e){function t(t){var n=e.call(this)||this;return n._projectManager=t,n._sol=n.disposeVar(new i.SceneObjectsListening(n._projectManager.sceneObjectsManager,(function(e){return new a(e,n._projectManager)}))),n}return o(t,e),t}(c.Destroyable);t.DoWithAllowPickingOnCreating=s},26058:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectConfig=void 0;var i=n(80468),c=n(51355),a=function(e){function t(t){var n=e.call(this)||this;return n._projectManager=t,n._settings=n.disposeVar((0,c.reactJson)({positionsEditing:i.PositionsEditing.defaultConfig,positionEditing:i.PositionEditing.defaultConfig})),n}return o(t,e),Object.defineProperty(t.prototype,"settings",{get:function(){return this._settings.value},set:function(e){this._settings.value=e,console.error("抱歉本方法已失效，未来会移除，请使用最新的defaultConfig的方式来设置编辑交互配置！https://www.wolai.com/vtxf/vYh5xrcX7CN5jfWBPwBLKg")},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"settingsChanged",{get:function(){return this._settings.changed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"projectManager",{get:function(){return this._projectManager},enumerable:!1,configurable:!0}),t}(c.Destroyable);t.ProjectConfig=a},4881:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function c(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},s=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},u=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.ProjectManager=void 0;var l=n(80468),f=n(51355),p=n(99085),d=n(92436),h=n(87612),b=n(83746),y=n(26058),v=n(41369),g=n(47486),O=n(48154),_=n(33919),j=n(79375),m=n(84984),w=function(e){function t(t,n){void 0===n&&(n=24);var r=e.call(this)||this;return r._itemDivHeight=n,r._dragstartDataMananger=r.disposeVar(new h.DragStartDataManager),r._asset=r.disposeVar((0,f.createProps)({name:"未命名项目",createdTime:"",modifiedTime:""})),r._sceneObjectsManager=r.disposeVar(new l.SceneObjectsManager),r._sceneObjectEditingManager=r.disposeVar(new v.SceneObjectEditingManager(r._sceneObjectsManager)),r._viewersManager=r.disposeVar(new l.ViewersManager(r._sceneObjectsManager)),r._userCreatedSceneObjects=new Set,r._defaultSceneTree=r.disposeVar(new d.SceneTree("default",r.dragstartDataMananger,r._itemDivHeight,r)),r._sceneTreeMap=new Map,r.updateSceneObjectOnPickingFunc=j.defaultUpdateSceneObjectOnPickingFunc,r.initSceneObjectOnCreatingFunc=j.defaultInitSceneObjectOnCreatingFunc,r._config=r.disposeVar(new y.ProjectConfig(r)),r._doWithAllowPickingOnCreating=r.disposeVar(new b.DoWithAllowPickingOnCreating(r)),r._sceneObjectsPicking=r.disposeVar(new g.SceneObjectsPicking(r)),r._sceneObjectSelectedFromViewersEvent=r.disposeVar(new f.Event),r._showSceneObjectsCreator=r.disposeVar(new O.ShowSceneObjectsCreator(r)),r._viewerPicking=r.disposeVar(new m.ViewerPicking(r)),r._propUiTreeManager=r.disposeVar(new p.PropUiTreeManager(r._itemDivHeight)),r.dispose((function(){r._userCreatedSceneObjects.size>0&&(console.warn("警告：存在用户自行创建的场景对象没有销毁！请在销毁ProjectManager之前提前调用destroySceneObject/destroyAllSceneObjects来完成场景对象的销毁！"),r.printAllUserCreatedSceneObjects(),r.destroyAllSceneObjects()),r.sceneTree.root.children&&r.sceneTree.root.children.length>0&&(console.warn("警告：有场景节点没有销毁！请在销毁ProjectManager之前提前调用destroySceneObjectTreeItem/destroyAllSceneObjectTreeItems来销毁场景节点！"),r.destroyAllSceneObjectTreeItems())})),r.defaultContainerOrId=t,r}return o(t,e),t.setEnv=function(e,t){l.SceneObject.context.setEnv(e,t)},t.getEnv=function(e){return l.SceneObject.context.getEnv(e)},t.envs=function(){return l.SceneObject.context.environmentVariables},Object.defineProperty(t.prototype,"dragstartDataMananger",{get:function(){return this._dragstartDataMananger},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"asset",{get:function(){return this._asset},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propUiTreeManager",{get:function(){return this._propUiTreeManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sceneObjectsManager",{get:function(){return this._sceneObjectsManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sceneObjectEditingManager",{get:function(){return this._sceneObjectEditingManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewersManager",{get:function(){return this._viewersManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userCreatedSceneObjects",{get:function(){return this._userCreatedSceneObjects},enumerable:!1,configurable:!0}),t.prototype.printAllUserCreatedSceneObjects=function(){var e,t;try{for(var n=a(this._userCreatedSceneObjects),r=n.next();!r.done;r=n.next()){var o=r.value,i=o.name,c=o.typeName,s=o.id;console.log("sceneObject name: ".concat(i," type: ").concat(c," id: ").concat(s))}}catch(t){e={error:t}}finally{try{r&&!r.done&&(t=n.return)&&t.call(n)}finally{if(e)throw e.error}}},t.prototype.propTreeCallback=function(e){return(0,_.propTreeCallback)(this,e)},Object.defineProperty(t.prototype,"defaultContainer",{get:function(){return this._viewersManager.defaultContainer},set:function(e){this._viewersManager.defaultContainer=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultContainerOrId",{set:function(e){this._viewersManager.defaultContainerOrId=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"defaultSceneTree",{get:function(){return this._defaultSceneTree},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sceneTree",{get:function(){return this._defaultSceneTree},enumerable:!1,configurable:!0}),t.prototype.getSceneTreeMap=function(){return this._sceneTreeMap},t.prototype.getSceneTree=function(e,t){if(void 0===t&&(t=24),"default"===e)return this._defaultSceneTree;if(!this._sceneTreeMap.has(e)){var n=this.disposeVar(new d.SceneTree(e,this.dragstartDataMananger,t,this));this._sceneTreeMap.set(e,n)}return this._sceneTreeMap.get(e)},Object.defineProperty(t.prototype,"jsonLoadingEvent",{get:function(){return this._defaultSceneTree.jsonLoadingEvent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this._config},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doWithAllowPickingOnCreating",{get:function(){return this._doWithAllowPickingOnCreating},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sceneObjectsPicking",{get:function(){return this._sceneObjectsPicking},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sceneObjectSelectedFromViewersEvent",{get:function(){return this._sceneObjectSelectedFromViewersEvent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showSceneObjectsCreator",{get:function(){return this._showSceneObjectsCreator},enumerable:!1,configurable:!0}),t.prototype._getJson=function(){return this.asset.modifiedTime=(new Date).toISOString(),{asset:{version:"0.1.0",createdTime:this.asset.createdTime,modifiedTime:this.asset.modifiedTime,name:this.asset.name},sceneTree:this.sceneTree.json}},Object.defineProperty(t.prototype,"json",{get:function(){return this._getJson()},set:function(e){this._setJson(e)},enumerable:!1,configurable:!0}),t.prototype._setJson=function(e){try{if("0.1.0"!==e.asset.version)return void console.warn("无法解析！");this.asset.createdTime=e.asset&&e.asset.createdTime||(new Date).toISOString(),this.asset.modifiedTime=e.asset&&e.asset.modifiedTime||"",this.asset.name=e.asset&&e.asset.name||"未命名项目",this.defaultSceneTree.json=e.sceneTree||{}}catch(e){console.error("json数据装配时发生错误！error: ".concat(e))}},Object.defineProperty(t.prototype,"jsonStr",{get:function(){return JSON.stringify(this.json,void 0,"    ")},set:function(e){try{this.json=e&&JSON.parse(e)||{asset:{version:"0.1.0"}}}catch(e){console.error("ProjectManager解析json数据时发生错误！error: ".concat(e))}},enumerable:!1,configurable:!0}),t.prototype.createSceneObject=function(e,t){var n=l.SceneObject.create(e,t);if(n)return this.sceneObjectsManager.addSceneObject(n),this._userCreatedSceneObjects.add(n),n},t.prototype.createSceneObjectFromClass=function(e,t){var n=l.SceneObject.createFromClass(e,t);if(n)return this.sceneObjectsManager.addSceneObject(n),this._userCreatedSceneObjects.add(n),n},t.prototype.createSceneObjectFromJson=function(e){var t=l.SceneObject.createFromJson(e);if(t)return this.sceneObjectsManager.addSceneObject(t),this._userCreatedSceneObjects.add(t),t},t.prototype.destroySceneObject=function(e){this._userCreatedSceneObjects.delete(e),this.sceneObjectsManager.deleteSceneObject(e),e.destroy()},t.prototype.destroyAllSceneObjects=function(){var e,t,n=u([],s(this._userCreatedSceneObjects),!1);try{for(var r=a(n),o=r.next();!o.done;o=r.next()){var i=o.value;this.destroySceneObject(i)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}},t.prototype.createSceneObjectTreeItem=function(e,t,n,r){return console.warn("createSceneObjectTreeItem 已被废弃！"),this.sceneTree.createSceneObjectTreeItem(e,t,n,r)},t.prototype.createGroupTreeItem=function(e,t,n,r){return console.warn("createGroupTreeItem 已被废弃！"),this.sceneTree.createGroupTreeItem(e,t,n,r)},t.prototype.createSceneObjectTreeItemFromClass=function(e,t,n,r){return console.warn("createSceneObjectTreeItemFromClass 已被废弃"),this.sceneTree.createSceneObjectTreeItemFromClass(e,t,n,r)},t.prototype.createSceneObjectTreeItemFromJson=function(e,t,n){return console.warn("createSceneObjectTreeItemFromJson 已被废弃"),this.sceneTree.createSceneObjectTreeItemFromJson(e,t,n)},t.prototype.destroySceneObjectTreeItem=function(e){return console.warn("destroySceneObjectTreeItem 已被废弃"),this.sceneTree.destroySceneObjectTreeItem(e)},t.prototype.destroyAllSceneObjectTreeItems=function(){return console.warn("destroyAllSceneObjectTreeItems 已被废弃"),this.sceneTree.destroyAllSceneObjectTreeItems()},t.prototype.getTreeItemFromSceneObject=function(e){return(0,j.getSceneObjectTreeItem)(e)},t.prototype.getSceneObjectById=function(e){return l.SceneObject.getSceneObjById(e)},t.prototype.selectSingleTreeItemWithSceneObject=function(e){if(this.sceneTree.uiTree.clearAllSelectedItems(),e){var t=(0,j.getSceneObjectTreeItem)(e);if(t){var n=t.uiTreeObject;n&&(n.selected=!0)}}},t.prototype.viewerPick=function(e,t,n){return void 0===n&&(n={}),i(this,void 0,void 0,(function(){return c(this,(function(r){switch(r.label){case 0:return[4,this._viewerPicking.viewerPick(e,t,n)];case 1:return[2,r.sent()]}}))}))},t.defaultUpdateSceneObjectOnPickingFunc=j.defaultUpdateSceneObjectOnPickingFunc,t.defaultInitSceneObjectOnCreatingFunc=j.defaultInitSceneObjectOnCreatingFunc,t}(f.Destroyable);t.ProjectManager=w,function(e){e.createDefaultProps=function(){return{currentPlayer:void 0,showPlayerView:!1,currenESCameraViewCollection:void 0,showESViewCollectionVue3UI:!1,currentESPlayer:void 0,showESPlayerVue3UI:!1,editingOnPicking:!0,allowPickingOnCreating:!0}}}(w=t.ProjectManager||(t.ProjectManager={})),t.ProjectManager=w,(0,f.extendClassProps)(w.prototype,w.createDefaultProps)},41369:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},c=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.SceneObjectEditingManager=t.SceneObjectEditing=void 0;var a=n(80468),s=n(51355);function u(e,t,n,r){if(n)r.currentActiveEditing=[e,t];else if(r.currentActiveEditing){var o=i(r.currentActiveEditing,2),c=o[0],a=o[1];c===e&&a===t&&(n||(r.currentActiveEditing=void 0))}}var l=["editing","positionEditing","locationEditing","pointEditing","rotationEditing"],f=function(e){function t(t,n){var r,o,i=e.call(this)||this;i._sceneObject=t;var a=i._sceneObject,s=function(e){var t=a[e+"Changed"];if(t){var r=a[e];u(a,e,r,n),f.dispose(t.disposableOn((function(t){return u(a,e,t,n)})))}},f=this;try{for(var p=c(l),d=p.next();!d.done;d=p.next())s(d.value)}catch(e){r={error:e}}finally{try{d&&!d.done&&(o=p.return)&&o.call(p)}finally{if(r)throw r.error}}return i}return o(t,e),Object.defineProperty(t.prototype,"sceneObject",{get:function(){return this._sceneObject},enumerable:!1,configurable:!0}),t}(s.Destroyable);t.SceneObjectEditing=f;var p=function(e){function t(t){var n=e.call(this)||this;return n._sceneObjectsManager=t,n._currentActiveEditing=n.disposeVar((0,s.reactArrayWithUndefined)(void 0)),n._currentActiveEditingLastChangedTime=0,n._currentActiveEditingInit=n.dispose(n._currentActiveEditing.changed.disposableOn((function(e,t){if(n._currentActiveEditingLastChangedTime=Date.now(),t){var r=i(t,2);!0===(o=r[0])[c=r[1]]&&(o[c]=!1)}if(e){var o,c,a=i(e,2);(o=a[0])[c=a[1]]=!0}}))),n._listening=n.disposeVar(new a.SceneObjectsListening(n._sceneObjectsManager,(function(e){return new f(e,n)}))),n}return o(t,e),Object.defineProperty(t.prototype,"currentActiveEditing",{get:function(){return this._currentActiveEditing.value},set:function(e){this._currentActiveEditing.value=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentActiveEditingChanged",{get:function(){return this._currentActiveEditing.changed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"currentActiveEditingLastChangedTime",{get:function(){return this._currentActiveEditingLastChangedTime},enumerable:!1,configurable:!0}),t}(s.Destroyable);t.SceneObjectEditingManager=p},47486:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.SceneObjectsPicking=void 0;var i=n(80468),c=n(51355),a=function(e){function t(t){var n=e.call(this)||this;return n._sceneObjectsPicking=t,n._viewersPicking=n.disposeVar(i.ViewersPicking.create(n._sceneObjectsPicking.projectManager.sceneObjectsManager,n._sceneObjectsPicking.pointerEventFuncs,n._sceneObjectsPicking)),n}return o(t,e),Object.defineProperty(t.prototype,"viewersPicking",{get:function(){return this._viewersPicking},enumerable:!1,configurable:!0}),t}(c.Destroyable),s=function(e){function t(n){var r=e.call(this)||this;return r._projectManager=n,r.pickedFunc=function(e){t.pickedFuncs.edit(e,r._projectManager)},r._pickedEvent=r.disposeVar(new c.Event),r._pointerEventFuncs=r.disposeVar((0,c.react)([["click",function(e){return!e.altKey&&!e.ctrlKey}]])),r._viewersPickingResetting=r.disposeVar(new i.ObjResettingWithEvent(r.pointerEventFuncsChanged,(function(){return new a(r)}))),r._pickType=r.disposeVar((0,c.react)("viewerPick")),r._watching=r.dispose(r.projectManager.sceneObjectsManager.sceneObjectPickedEvent.disposableOn((function(e){r.pickedFunc(e)}))),r}return o(t,e),Object.defineProperty(t.prototype,"pickedEvent",{get:function(){return this._pickedEvent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pointerEventFuncs",{get:function(){return this._pointerEventFuncs.value},set:function(e){this._pointerEventFuncs.value=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pointerEventFuncsChanged",{get:function(){return this._pointerEventFuncs.changed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"viewersPickingResetting",{get:function(){return this._viewersPickingResetting},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"projectManager",{get:function(){return this._projectManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pickType",{get:function(){return this._pickType.value},set:function(e){this._pickType.value=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"pickTypeChanged",{get:function(){return this._pickType.changed},enumerable:!1,configurable:!0}),t.pickedFuncs={edit:function(e,t){if(t.editingOnPicking){var n=e&&e.sceneObject;t.sceneObjectEditingManager.currentActiveEditing||(n&&(Reflect.has(n,"editing")?n.editing=!0:Reflect.has(n,"positionEditing")&&(n.positionEditing=!0)),t.selectSingleTreeItemWithSceneObject(n),t.sceneObjectSelectedFromViewersEvent.emit(n,e))}},info:function(e,t){var n=e&&e.sceneObject,r=n?"拾取到的场景对象的名称是：".concat(n.name):"没有拾取到场景对象！";alert(r),t.sceneObjectSelectedFromViewersEvent.emit(n,e)}},t}(c.Destroyable);t.SceneObjectsPicking=s},48154:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function c(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ShowSceneObjectsCreator=void 0;var a=n(51355),s=n(59645),u=function(e){function t(t){var n=e.call(this)||this;return n._projectManager=t,n._showCreatorEvent=n.disposeVar(new a.Event),n._selectTypeOkEvent=n.disposeVar(new a.Event),n._isEnable=n.disposeVar((0,a.react)(!1)),n._selectType=n.disposeVar((0,a.react)(void 0)),n._processing=n.disposeVar((0,s.createProcessingFromAsyncFunc)((function(e){return i(n,void 0,void 0,(function(){var e=this;return c(this,(function(t){return this.selectType=void 0,this.isEnable=!1,this.showCreator(),this.dispose(this.selectTypeOkEvent.disposableOn((function(t){e.selectType=t}))),[2]}))}))}))),n.dispose(n.showCreatorEvent.disposableOn((function(){n.isEnable=!0}))),n}return o(t,e),Object.defineProperty(t.prototype,"showCreatorEvent",{get:function(){return this._showCreatorEvent},enumerable:!1,configurable:!0}),t.prototype.showCreator=function(){return this._showCreatorEvent.emit()},Object.defineProperty(t.prototype,"selectTypeOkEvent",{get:function(){return this._selectTypeOkEvent},enumerable:!1,configurable:!0}),t.prototype.selectTypeOk=function(e){return this._selectTypeOkEvent.emit(e)},Object.defineProperty(t.prototype,"isEnable",{get:function(){return this._isEnable.value},set:function(e){this._isEnable.value=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isEnableChanged",{get:function(){return this._isEnable.changed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectType",{get:function(){return this._selectType.value},set:function(e){this._selectType.value=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"selectTypeChanged",{get:function(){return this._selectType.changed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"processing",{get:function(){return this._processing},enumerable:!1,configurable:!0}),t}(a.Destroyable);t.ShowSceneObjectsCreator=u},84984:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function c(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.ViewerPicking=void 0;var a=n(9675),s=n(80468),u=n(81901),l=function(e){function t(t,n,r,o){var l=e.call(this,t)||this;return l._viewer=n,l._windowPos=r,l._attachedInfo=o,l._resultEvent=l.disposeVar(new a.Event),l._processing=l.disposeVar((0,u.createProcessingFromAsyncFunc)((function(e){return i(l,void 0,void 0,(function(){var t,n,r,o,i=this;return c(this,(function(c){switch(c.label){case 0:return this.dispose(this.owner.owner.sceneObjectsManager.sceneObjectPickedEvent.disposableOn((function(e){s.PickedInfo.getFinalAttachedInfo(e)===i._attachedInfo&&(t=e)}))),(n=this._viewer.pickAndEmit(this._windowPos,this._attachedInfo))instanceof Promise?[4,e.promise(n)]:[3,2];case 1:return o=c.sent(),[3,3];case 2:o=n,c.label=3;case 3:if((r=o)&&!t&&this.owner.debug&&console.warn("可能是拾取到了某个对象，但是并非XE2的场景对象！",r),!r&&t)throw console.error("!pickedInfo && result 绝不可能出现没有拾取结果，但是居然有拾取到了某个场景对象！"),new Error("!pickedInfo && result");return this.resultEvent.emit(t,r,this._viewer),[2]}}))}))}))),l._processing.start(),l}return o(t,e),Object.defineProperty(t.prototype,"resultEvent",{get:function(){return this._resultEvent},enumerable:!1,configurable:!0}),t}(a.HasOwner),f=function(e){function t(t){var n=e.call(this,t)||this;return n.debug=!1,n}return o(t,e),t.prototype.viewerPick=function(e,t,n){return i(this,void 0,void 0,(function(){var r=this;return c(this,(function(o){return[2,new Promise((function(o,i){var c=new l(r,e,t,n),a=c.resultEvent.disposableOnce((function(e,t){a(),c.destroy(),o({sceneObjectPickedInfo:e,nativePickedInfo:t,czmPickedResult:t instanceof s.CzmPickedInfo?t.czmPickResult:void 0,attachedInfo:n})}))}))]}))}))},t}(a.HasOwner);t.ViewerPicking=f},93753:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(47486),t),o(n(4881),t)},33919:function(e,t,n){var r=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c};Object.defineProperty(t,"__esModule",{value:!0}),t.propTreeCallback=void 0;var o=n(92436),i=n(87612),c=n(80468);function a(e){if(e.data){var t=e.data,n=t.type,r=t.value;if("UITreeA"===n&&r instanceof o.SceneTreeItem){var i=r.sceneObject;if(i)return i.id}}}t.propTreeCallback=function(e,t){var n=t.property,o=t.customEventName,s=t.otherParams,u=e.dragstartDataMananger;if(n instanceof c.PositionProperty);else if(n instanceof c.PositionsProperty);else if(n instanceof c.StringProperty){var l=r((0,i.getReactFuncs)(n.reactVar),2),f=(l[0],l[1]);if("ondragover"===o){if(console.log("ondragover"),!s)throw new Error("!otherParams");if((h=s[0]).preventDefault(),!h.dataTransfer)return;a(u)?h.dataTransfer.dropEffect="move":h.dataTransfer.dropEffect="none"}else if("ondrop"===o){if(!s)throw new Error("!otherParams");(h=s[0]).preventDefault(),void 0!==(d=a(u))&&f(d)}}else if(n instanceof c.StringsProperty){var p=r((0,i.getReactFuncs)(n.reactVar),2);if(p[0],f=p[1],"ondragover"===o){if(console.log("ondragover"),!s)throw new Error("!otherParams");if((h=s[0]).preventDefault(),!h.dataTransfer)return;a(u)?h.dataTransfer.dropEffect="move":h.dataTransfer.dropEffect="none"}else if("ondrop"===o){if(!s)throw new Error("!otherParams");var d,h=s[0].$event,b=s[0].strinsPropDom,y=s[0].index;if(h.preventDefault(),void 0!==(d=a(u))){b[y].firstChild.value=d;var v=new Event("input",{bubbles:!0,cancelable:!0});b[y].firstChild.dispatchEvent(v)}}}else if(n instanceof c.String2sProperty){var g=r((0,i.getReactFuncs)(n.reactVar),2);g[0],f=g[1]}}},96985:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultInitSceneObjectOnCreatingFunc=void 0,t.defaultInitSceneObjectOnCreatingFunc=function(e){["Czm3DTiles","View","ESCameraView","OlView","GeoCameraController"].includes(e.typeName)||(Reflect.has(e,"editing")?e.editing=!0:Reflect.has(e,"positionEditing")&&(e.positionEditing=!0)),"function"==typeof e.execOnCreating&&e.execOnCreating()}},81092:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultUpdateSceneObjectOnPickingFunc=void 0,t.defaultUpdateSceneObjectOnPickingFunc=function(e,t){t&&(Reflect.has(t,"editing")?t.editing=!0:Reflect.has(t,"positionEditing")&&(t.positionEditing=!0))}},79375:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(81092),t),o(n(96985),t),o(n(97555),t)},97555:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSceneObjectTreeItem=t.setSceneObjectTreeItem=void 0;var r=n(51355);t.setSceneObjectTreeItem=function(e,t){(0,r.getExtProp)(e,"__treeItem")&&console.error("setSceneObjectTreeItem error!"),(0,r.setExtProp)(e,"__treeItem",t)},t.getSceneObjectTreeItem=function(e){return(0,r.getExtProp)(e,"__treeItem")}},15824:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.PropTree=void 0;var i=function(e){function t(t){return e.call(this,t)||this}return o(t,e),Object.defineProperty(t.prototype,"propUiTree",{get:function(){return this.uiTree},enumerable:!1,configurable:!0}),t}(n(87612).Tree);t.PropTree=i},39419:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.GroupPropTreeItem=t.LeafPropTreeItem=t.BasePropTreeItem=void 0;var i=function(e){function t(t,n,r){var o=e.call(this,t,n)||this;return o._property=r,o}return o(t,e),Object.defineProperty(t.prototype,"property",{get:function(){return this._property},enumerable:!1,configurable:!0}),t}(n(87612).TreeItem);t.BasePropTreeItem=i;var c=function(e){function t(t,n){return e.call(this,t,!1,n)||this}return o(t,e),t}(i);t.LeafPropTreeItem=c;var a=function(e){function t(t,n){return e.call(this,t,!0,n)||this}return o(t,e),Object.defineProperty(t.prototype,"groupChildren",{get:function(){return this.children},enumerable:!1,configurable:!0}),t}(i);t.GroupPropTreeItem=a},27851:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.PropUiTreeManager=t.createPropTreeFromSceneObject=void 0;var s=n(51355),u=n(80468),l=n(80468),f=n(59645),p=n(15824),d=n(39419);function h(e,t){var n,r,o,s,l=new p.PropTree(t),f=e.getProperties("chinese"),h=[],b=function(e){if(e instanceof u.GroupProperty){var t=new d.GroupPropTreeItem(l,e);t.dispose((function(){return e.destroy()})),l.children.push(t),h.push(t)}else{var n=new d.LeafPropTreeItem(l,e);l.children.push(n),n.dispose((function(){return e.destroy()}))}};try{for(var y=i(f),v=y.next();!v.done;v=y.next())b(v.value)}catch(e){n={error:e}}finally{try{v&&!v.done&&(r=y.return)&&r.call(y)}finally{if(n)throw n.error}}for(;h.length>0;){var g=h.pop();if(!g)throw new Error("should not be here!");var O=g;if(!(O.property instanceof u.GroupProperty))throw new Error("!(treeItem.property instanceof GroupProperty)");var _=function(e){if(e instanceof u.GroupProperty){var t=new d.GroupPropTreeItem(l,e);t.dispose((function(){return e.destroy()})),O.groupChildren.push(t),h.push(t)}else{var n=new d.LeafPropTreeItem(l,e);O.groupChildren.push(n),n.dispose((function(){return e.destroy()}))}};try{for(var j=(o=void 0,i(O.property.children)),m=j.next();!m.done;m=j.next())_(m.value)}catch(e){o={error:e}}finally{try{m&&!m.done&&(s=j.return)&&s.call(j)}finally{if(o)throw o.error}}}return l.dispose((function(){l.itemChildrenChanged.reset(),l.itemChildrenToChange.reset();var e=a([],c(l.getDescendants()),!1);e.forEach((function(e){e.children&&(e.children.length=0),e.destroy()})),e.length=0})),l}t.createPropTreeFromSceneObject=h;var b=function(e){function t(t){var n=e.call(this)||this;return n._propTreeReact=n.disposeVar((0,s.react)(void 0)),n.dispose((function(){return n._propTreeReact.value=void 0})),n.disposeVar(new f.ObjResettingWithEvent(n.sceneObjectChanged,(function(e){if(e){var t=new s.Destroyable;return t.dispose(e.toDestroyEvent.disposableOn((function(){n.sceneObject=void 0}))),t}}))),n.dispose(n.sceneObjectChanged.disposableOn((function(e){n._propTreeReact.value=void 0,e&&e instanceof l.ESSceneObject&&(n._propTreeReact.value=h(e,t))}))),n}return o(t,e),Object.defineProperty(t.prototype,"propTree",{get:function(){return this._propTreeReact.value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"propTreeChanged",{get:function(){return this._propTreeReact.changed},enumerable:!1,configurable:!0}),t}(s.Destroyable);t.PropUiTreeManager=b,function(e){e.createDefaultProps=function(){return{sceneObject:void 0}}}(b=t.PropUiTreeManager||(t.PropUiTreeManager={})),t.PropUiTreeManager=b,(0,s.extendClassProps)(b.prototype,b.createDefaultProps)},99085:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(15824),t),o(n(39419),t),o(n(27851),t)},44876:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},c=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},a=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.SceneTree=void 0;var s=n(80468),u=n(87612),l=n(4079),f=n(8348),p=n(26834),d=n(60305),h=n(98421),b=n(75373),y=n(43370),v=n(51355),g=n(79375);function O(e){return e.name+"_clone"}function _(e,t,n){return e instanceof l.SceneTreeItem?e.insertNewTreeItem(t,n):e.insertNewTreeItem({FolderInnerOrAfter:"InnerOrAfter",FolderInnerOrBefore:"InnerOrBefore",FolderInner:"Inner",InnerOrAfter:"InnerOrAfter",InnerOrBefore:"InnerOrBefore",Inner:"Inner",After:"After",Before:"Before"}[t],n)}var j=function(e){function t(n,r,o,s){var u=e.call(this,o)||this;u._name=n,u._dragStartDataManager=r,u._projectManager=s,u._jsonLoading=u.disposeVar(new f.SceneTreeJsonLoading(u)),u.createSceneObjectFunc=t.defaultCreateSceneObjectFunc,u.createTreeItemDragDropFunc=t.defaultCreateTreeItemDragDropFunc,u.preloadFunc=t.defaultPreload,u.getSceneObjectShowFunc=t.defaultGetSceneObjectShow,u.setSceneObjectShowFunc=t.defaultSetSceneObjectShow,u.getSceneTreeItemCloneNameFunc=t.defaultGetSceneTreeItemCloneNameFunc,u.debug=!1,u._contextMenu=u.disposeVar(new y.SceneTreeContextMenu(u,u.projectManager)),u._showPropUiOnSelecting=u.disposeVar((0,v.react)(!0)),u.dispose(u.selectedItems.changedEvent.disposableOn((function(){var e,t,n;window.lssn=u.lastSelectedItem,window.lsso=null===(e=u.lastSelectedItem)||void 0===e?void 0:e.sceneObject,u.debug&&console.log(null!==(n=null===(t=u.lastSelectedItem)||void 0===t?void 0:t.sceneObject)&&void 0!==n?n:"select null")})));var l=u._projectManager.sceneObjectsManager;return u.dispose(u.itemsDeleted.disposableOn((function(e){var t,n,r,o,s;try{for(var u=a(e),f=u.next();!f.done;f=u.next()){var p=f.value,d=p,h=d.sceneObject;h&&l.deleteSceneObject(h)&&h.destroy()&&(0,g.setSceneObjectTreeItem)(h,void 0);try{for(var b=(r=void 0,a(d.getDescendants())),y=b.next();!y.done;y=b.next()){var v=y.value.sceneObject;v&&l.deleteSceneObject(v)&&v.destroy()&&(0,g.setSceneObjectTreeItem)(v,void 0)}}catch(e){r={error:e}}finally{try{y&&!y.done&&(o=b.return)&&o.call(b)}finally{if(r)throw r.error}}c([s=p],i(s.getDescendants()),!1).forEach((function(e){return e.destroy()}))}}catch(e){t={error:e}}finally{try{f&&!f.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}}))),u.dispose(u.itemsAdded.disposableOn((function(e){var t,n,r,o;try{for(var i=a(e),c=i.next();!c.done;c=i.next()){var s=c.value;s.sceneObject&&l.addSceneObject(s.sceneObject)&&(0,g.setSceneObjectTreeItem)(s.sceneObject,s);try{for(var u=(r=void 0,a(s.getDescendants())),f=u.next();!f.done;f=u.next()){var p=f.value;p.sceneObject&&l.addSceneObject(p.sceneObject)&&(0,g.setSceneObjectTreeItem)(p.sceneObject,p)}}catch(e){r={error:e}}finally{try{f&&!f.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}}))),u.dispose(u.selectedItems.changedEvent.disposableOn((function(){if(u.showPropUiOnSelecting){u._projectManager.propUiTreeManager.sceneObject=void 0;var e=u.lastSelectedItem;e&&(u._projectManager.propUiTreeManager.sceneObject=e.sceneObject)}}))),u}return o(t,e),Object.defineProperty(t.prototype,"json",{get:function(){return this._jsonLoading.json},set:function(e){this._jsonLoading.json=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"jsonStr",{get:function(){return this._jsonLoading.jsonStr},set:function(e){this._jsonLoading.jsonStr=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"jsonLoadingEvent",{get:function(){return this._jsonLoading.jsonLoadingEvent},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"projectManager",{get:function(){return this._projectManager},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"contextMenu",{get:function(){return this._contextMenu},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showPropUiOnSelecting",{get:function(){return this._showPropUiOnSelecting.value},set:function(e){this._showPropUiOnSelecting.value=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"showPropUiOnSelectingChanged",{get:function(){return this._showPropUiOnSelecting.changed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sceneUiTree",{get:function(){return this.uiTree},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dragStartDataManager",{get:function(){return this._dragStartDataManager},enumerable:!1,configurable:!0}),t.prototype.getJson=function(){return{root:{children:c([],i(this.children),!1).filter((function(e){return e.isExport})).map((function(e){return e.json}))}}},t.prototype.setJson=function(e){var t,n,r,o;e.root=e.root||{};var i=null!==(r=e.root.children)&&void 0!==r?r:[];this.root.resetChildren(!0);try{for(var c=a(i),s=c.next();!s.done;s=c.next()){var u=s.value,f=new l.SceneTreeItem(this,!0);f.json=u,null===(o=this.root.children)||void 0===o||o.push(f)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}},t.prototype.testAddNewTreeItem=function(e,t){var n=e||this.lastSelectedItem||this.root;return!!n&&_(n,t)},t.prototype.addNewTreeItem=function(e,t,n,r){var o=e||this.lastSelectedItem||this.root;if(o&&_(o,t)){var i=new l.SceneTreeItem(this,n);if(i.sceneObject=r,!_(o,t,i))throw new Error("currentTreeItem.insertNewTreeItem return false!");return i}},t.prototype.createSceneObjectTreeItem=function(e,t,n,r){var o=null!=r?r:"FolderInnerOrAfter";if(this.testAddNewTreeItem(n,o)){var i=s.SceneObject.create(e,t);if(i)return this.addNewTreeItem(n,null!=r?r:"FolderInnerOrAfter",!0,i)}else console.warn("cannot addNewTreeItem! currentTreeItem(".concat(n?n.id:"root",")"))},t.prototype.createGroupTreeItem=function(e,t,n,r){var o=null!=r?r:"FolderInnerOrAfter";if(this.testAddNewTreeItem(n,o)){var i=this.addNewTreeItem(n,null!=r?r:"FolderInnerOrAfter",!0);if(i)return i.name=null!=e?e:"未命名组节点",i;console.warn("addNewTreeItem error!")}else console.warn("cannot addNewTreeItem! currentTreeItem(".concat(n?n.id:"root",")"))},t.prototype.createSceneObjectTreeItemFromClass=function(e,t,n,r){var o=null!=r?r:"FolderInnerOrAfter";if(this.testAddNewTreeItem(n,o)){var i=s.SceneObject.createFromClass(e,t);if(i)return this.addNewTreeItem(n,o,!0,i)}},t.prototype.createSceneObjectTreeItemFromJson=function(e,t,n){var r=null!=n?n:"FolderInnerOrAfter";if(this.testAddNewTreeItem(t,r)){var o=s.SceneObject.createFromJson(e);if(o)return this.addNewTreeItem(t,null!=n?n:"FolderInnerOrAfter",!0,o)}},t.prototype.destroySceneObjectTreeItem=function(e){e!==this.root?e.detachFromParent():console.warn("cannot destroy root! please use function destroyAllSceneObjectTreeItems!")},t.prototype.destroyAllSceneObjectTreeItems=function(){var e,t;if(this.root.children){var n=c([],i(this.root.children),!1);try{for(var r=a(n),o=r.next();!o.done;o=r.next()){var s=o.value;this.destroySceneObjectTreeItem(s)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}},t.defaultCreateSceneObjectFunc=p.defaultCreateSceneObject,t.defaultCreateTreeItemDragDropFunc=d.defaultCreateTreeItemDragDrop,t.defaultPreload=b.preload,t.defaultGetSceneObjectShow=h.getSceneObjectShow,t.defaultSetSceneObjectShow=h.setSceneObjectShow,t.defaultGetSceneTreeItemCloneNameFunc=O,t}(u.Tree);t.SceneTree=j},43370:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},c=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.SceneTreeContextMenu=void 0;var a=n(51355),s=n(80468),u=n(48269),l=function(e,t){var n=[];t.selectedItems._innerObj.forEach((function(e){var t=e.sceneObject;t&&n.push(t.positions)}));var r=t.createSceneObjectTreeItem("GeoPolylines",void 0,e,"After");r&&(r.sceneObject.positions=n)},f=function(e,t){var n=e.sceneObject.positions;n?n.forEach((function(n){var r=t.createSceneObjectTreeItem("GeoPolyline",void 0,e,"After");r&&(r.sceneObject.positions=n)})):console.error("折线集合内无数据")},p=function(e,t){var n=[];t.selectedItems._innerObj.forEach((function(e){var t=e.sceneObject;t&&n.push(t.positions)}));var r=t.createSceneObjectTreeItem("CzmSignalTransmissionCollection",void 0,e,"After");r&&(r.sceneObject.positionsSet=n)},d=function(e,t){var n=e.sceneObject.positionsSet;n?n.forEach((function(n){var r=t.createSceneObjectTreeItem("CzmSignalTransmission",void 0,e,"After");r&&(r.sceneObject.positions=n)})):console.error("传输器集合内无数据")},h=function(e,t){var n=[];t.selectedItems._innerObj.forEach((function(e){var t=e.sceneObject;t&&n.push({viewDistance:t.viewDistance,duration:t.duration?t.duration:1e3,position:t.position,rotation:t.rotation,thumbnail:t.thumbnail})}));var r=t.createSceneObjectTreeItem("ViewCollection",void 0,e,"After");r&&(r.sceneObject.views=n)},b=function(e,t){var n=e.sceneObject.views;n?n.forEach((function(n){var r,o,i,c=t.createSceneObjectTreeItem("View",void 0,e,"After");if(c){var a=c.sceneObject;a.position=n.position,a.rotation=null!==(r=n.rotation)&&void 0!==r?r:[0,0,0],a.viewDistance=null!==(o=n.viewDistance)&&void 0!==o?o:0,a.duration=n.duration,a.thumbnail=null!==(i=n.thumbnail)&&void 0!==i?i:""}})):console.error("视角集合内无数据")},y=function(e){function t(n,r){var o=e.call(this)||this;return o._sceneTree=n,o._projectManager=r,o.treeItemContexMenuCallback=t.defaultTreeItemContexMenuCallback,o}return o(t,e),Object.defineProperty(t.prototype,"sceneTree",{get:function(){return this._sceneTree},enumerable:!1,configurable:!0}),t.defaultPlayerTreeItemContexMenuCallback=function(e,t,n,r){if(t){var o=t.sceneObject;if(o&&o instanceof s.Player){var a={text:"详情面板",keys:"",func:function(){r.currentPlayer=o,r.showPlayerView=!0}};e.unshift(a)}var y=[{text:"合并为折线集合并保留折线",keys:"",func:function(){l(t,n)}},{text:"合并为折线集合并删除折线",keys:"",func:function(){l(t,n),c([],i(n.selectedItems),!1).forEach((function(e){e.isDestroyed()||e.detachFromParent()}))}}];if(o&&o instanceof s.GeoPolyline&&n.selectedItems.length>=2){var v=0;n.selectedItems._innerObj.forEach((function(e){"GeoPolyline"===e.type&&(v+=1)})),v===n.selectedItems.length&&y.forEach((function(t){e.push(t)}))}var g=[{text:"打散为折线并保留折线集合",keys:"",func:function(){f(t,n)}},{text:"打散为折线并删除折线集合",keys:"",func:function(){f(t,n),t.isDestroyed()||t.detachFromParent()}}];o&&o instanceof s.GeoPolylines&&g.forEach((function(t){e.push(t)}));var O=[{text:"合并为信号传输器集合并保留信号传输器",keys:"",func:function(){p(t,n)}},{text:"合并为信号传输器集合并删除信号传输器",keys:"",func:function(){p(t,n),c([],i(n.selectedItems),!1).forEach((function(e){e.isDestroyed()||e.detachFromParent()}))}}];if(o&&o instanceof u.CzmSignalTransmission&&n.selectedItems.length>=2){var _=0;n.selectedItems._innerObj.forEach((function(e){"CzmSignalTransmission"===e.type&&(_+=1)})),_===n.selectedItems.length&&O.forEach((function(t){e.push(t)}))}var j=[{text:"打散为信号传输器集合并保留信号传输器",keys:"",func:function(){d(t,n)}},{text:"打散为信号传输器集合并删除信号传输器",keys:"",func:function(){d(t,n),t.isDestroyed()||t.detachFromParent()}}];o&&o instanceof u.CzmSignalTransmissionCollection&&j.forEach((function(t){e.push(t)}));var m=[{text:"合并为视角集合并保留视角",keys:"",func:function(){h(t,n)}},{text:"合并为视角集合并删除视角",keys:"",func:function(){h(t,n),c([],i(n.selectedItems),!1).forEach((function(e){e.isDestroyed()||e.detachFromParent()}))}}];if(o&&o instanceof s.View&&n.selectedItems.length>=2){var w=0;n.selectedItems._innerObj.forEach((function(e){"View"===e.type&&(w+=1)})),w===n.selectedItems.length&&m.forEach((function(t){e.push(t)}))}var S=[{text:"打散为视角并保留视角集合",keys:"",func:function(){b(t,n)}},{text:"打散为视角并删除视角集合",keys:"",func:function(){b(t,n),t.isDestroyed()||t.detachFromParent()}}];o&&o instanceof s.ViewCollection&&S.forEach((function(t){e.push(t)}))}},t.defaultTreeItemContexMenuCallback=function(e,n,r,o){t.defaultPlayerTreeItemContexMenuCallback(e,n,r,o)},t}(a.Destroyable);t.SceneTreeContextMenu=y},4079:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},c=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},a=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.SceneTreeItem=void 0;var s=n(51355),u=n(87612),l=n(59645);function f(e){var t=e.children&&(0,s.every)(e.children,(function(e){if(!(e instanceof p))throw new Error("!(treeItem instanceof SceneTreeItem)");return!e.show}))||!1,n=e.sceneTree.getSceneObjectShowFunc(e.sceneObject);return!t||n}var p=function(e){function t(n,r,o,c,a){void 0===r&&(r=!1),void 0===a&&(a=!0);var u,p=e.call(this,n,r,o)||this;p._showChangedNotAffectChildren=!1,p._showChangedNotAffectParent=!1,p._type=p.disposeVar((0,s.react)("Unknown")),p._isExport=p.disposeVar((0,s.react)(!0)),p.dispose(p.nameChanged.disposableOn((function(){return p.tree&&p.tree.itemsChanged.emit([p])}))),p.name="未命名条目(".concat(p.id,")"),p.extras=c,p._isExport.value=a;var d=function(){u&&(u(),u=void 0)};p.dispose(d),p.dispose(p.sceneObjectChanged.disposableOn((function(e){d(),e&&(u=(0,s.bind)([p,"name"],[e,"name"]))}))),p.dispose(p.showChanged.disposableOn((function(e){var r,o;if(n.setSceneObjectShowFunc(p.sceneObject,e),p.tree&&p.tree.forceRedraw(),p.children&&!p._showChangedNotAffectChildren)try{for(var c=i(p.children),a=c.next();!a.done;a=c.next()){var s=a.value;s instanceof t&&(s._showChangedNotAffectParent=!0,s.show=e,s._showChangedNotAffectParent=!1)}}catch(e){r={error:e}}finally{try{a&&!a.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}p.parent&&p.parent instanceof t&&!p._showChangedNotAffectParent&&(p.parent._showChangedNotAffectChildren=!0,p.parent.show=f(p.parent),p.parent._showChangedNotAffectChildren=!1)}))),p.disposeVar(new l.ObjResettingWithEvent(p.sceneObjectChanged,(function(){if(p.sceneObject){var e=new s.Destroyable;if("show"in p.sceneObject&&"showChanged"in p.sceneObject&&p.sceneObject.showChanged instanceof s.Event)(t=function(){p.show=n.getSceneObjectShowFunc(p.sceneObject)})(),e.dispose(p.sceneObject.showChanged.disposableOn(t));else if("enabled"in p.sceneObject&&"enabledChanged"in p.sceneObject&&p.sceneObject.enabledChanged instanceof s.Event){var t;(t=function(){p.show=n.getSceneObjectShowFunc(p.sceneObject)})(),e.dispose(p.sceneObject.enabledChanged.disposableOn(t))}return e}}))),p.childrenChangedEvent.disposableOn((function(){var e=f(p);p._showChangedNotAffectChildren=!0,p.show=e,p._showChangedNotAffectChildren=!1}));var h=function(){var e="Unknown";p.sceneObject?e=p.sceneObject.typeName:p.children&&(e="Folder"),p._type.value=e};return p.dispose(p.sceneObjectChanged.disposableOn(h)),p.dispose(p.childrenResetedEvent.disposableOn(h)),h(),p}return o(t,e),Object.defineProperty(t.prototype,"dragDrop",{get:function(){return this._dragDrop||(this._dragDrop=this.disposeVar(this.sceneTree.createTreeItemDragDropFunc(this))),this._dragDrop},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this._type.value},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"typeChanged",{get:function(){return this._type.changed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExport",{get:function(){return this._isExport.value},set:function(e){this._isExport.value=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isExportChanged",{get:function(){return this._isExport.changed},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sceneTree",{get:function(){return this.tree},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"jsonStr",{get:function(){return JSON.stringify(this.json,void 0,"    ")},set:function(e){try{this.json=JSON.parse(e)}catch(e){console.error("sceneTreeItem.jsonStr error ".concat(e),e)}},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"json",{get:function(){var e=this.children&&a([],c(this.children),!1).filter((function(e){return e.isExport})).map((function(e){return e.json}));return{name:this.name,show:!!this.show&&void 0,collapsed:!!this.uiTreeObject.collapsed||void 0,sceneObj:this.sceneObject&&this.sceneObject.json,children:e,extras:this.extras}},set:function(e){var n,r,o,c;if(void 0!==e.name&&(this.name=e.name),this._showChangedNotAffectChildren=!0,this._showChangedNotAffectParent=!0,this.show=null===(o=e.show)||void 0===o||o,this._showChangedNotAffectChildren=!1,this._showChangedNotAffectParent=!1,this.uiTreeObject.collapsed=null!==(c=e.collapsed)&&void 0!==c&&c,this.sceneObject=void 0,e.sceneObj&&(this.sceneObject=this.sceneTree.createSceneObjectFunc(e.sceneObj,this)),e.children){if(this.resetChildren(!0),!this.children)throw new Error("resetChildren(true) cannot get children!");try{for(var a=i(e.children),s=a.next();!s.done;s=a.next()){var u=s.value,l=new t(this.tree,!0);l.json=u,this.children.push(l)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}}},enumerable:!1,configurable:!0}),t.prototype.clone=function(){try{var e=new t(this.sceneTree,!!this.children,void 0,this.extras,this.isExport);return e.json=this.json,e.name=this.sceneTree.getSceneTreeItemCloneNameFunc(this),e}catch(e){console.error("SceneTreeItem.clone error: ".concat(e),e)}},t.prototype.insertNewTreeItem=function(t,n){if("FolderInnerOrAfter"===t||"FolderInnerOrBefore"===t||"FolderInner"===t){if(n&&n.tree!==this.tree)return console.warn("newTreeItem.tree !== this.tree"),!1;do{if(!this.children)break;if(t.includes("Or")&&this.sceneObject)break;return n&&this.children.push(n),!0}while(0);if("FolderInner"===t)return!1;if("FolderInnerOrAfter"===t)return e.prototype.insertNewTreeItem.call(this,"After",n);if("FolderInnerOrBefore"===t)return e.prototype.insertNewTreeItem.call(this,"Before",n);throw new Error("should not be here!")}return e.prototype.insertNewTreeItem.call(this,t,n)},t}(u.TreeItem);t.SceneTreeItem=p,function(e){e.createDefaultProps=function(){return{name:"未命名条目",nameEditing:!1,sceneObject:void 0,show:!0,extras:(0,s.reactJsonWithUndefined)(void 0)}}}(p=t.SceneTreeItem||(t.SceneTreeItem={})),t.SceneTreeItem=p,(0,s.extendClassProps)(p.prototype,p.createDefaultProps)},91396:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),c=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)c.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return c},c=this&&this.__spreadArray||function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};Object.defineProperty(t,"__esModule",{value:!0}),t.SceneTreeItemDragDrop=void 0;var a=n(59645);function s(e,t,n){var r=t.offsetY;return t.target&&"clientTop"in t.target?(r+=2,r+=t.target.clientTop,e.children?r<=.3*n?"before":r>=.7*n?!e.uiTreeObject.collapsed&&e.children.length>0?"inner":"after":"inner":r<=.5*n?"before":"after"):"none"}var u=function(e){function t(t){var n=e.call(this)||this;n._treeItem=t;var r=n._treeItem.sceneTree.dragStartDataManager,o="none",u=n.disposeVar((0,a.createTimeoutWithStartValues)((function(){n._treeItem.uiTreeObject.moveToPositionMode=o,console.log("uiTreeObject.moveToPositionMode = lastDragMode(".concat(o,");"))}),200));function l(e){o!==e&&(o=e,u.restart())}return n.dispose(n._dragStartEvent.disposableOn((function(e){r.data={type:"UITreeA",value:n._treeItem}}))),n.dispose(n._dragOverEvent.disposableOn((function(e){if(e.dataTransfer){e.preventDefault();do{var t=r;if(!t.data||"UITreeA"!==t.data.type||void 0===t.data.value)break;var o=t.data.value,u=n._treeItem,f=u.tree;if(!f)break;var p=c([],i(f.selectedItems),!1);~p.indexOf(o)||p.push(o);var d=s(u,e,f.itemDivHeight);if("none"===d)break;if(!a.Tree.canMoveToTreeItems(p,u,d))break;return e.dataTransfer.dropEffect="move",void l(d)}while(0);e.dataTransfer.dropEffect="none",l("none")}}))),n.dispose(n._dropEvent.disposableOn((function(e){var t=r;if(t.data&&"UITreeA"===t.data.type&&void 0!==t.data.value){var o=t.data.value,u=n._treeItem,f=u.tree;if(f){var p=c([],i(f.selectedItems),!1);~p.indexOf(o)||p.push(o);var d=s(u,e,f.itemDivHeight);"none"!==d&&a.Tree.canMoveToTreeItems(p,u,d)&&(a.Tree.moveToTreeItems(p,u,d),t.data=void 0,l("none"))}}}))),n.dispose(n._dragLeaveEvent.disposableOn((function(){o="none",u.restart()}))),n}return o(t,e),t}(n(94882).TreeItemDragDrop);t.SceneTreeItemDragDrop=u},8348:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function c(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SceneTreeJsonLoading=void 0;var a=n(51355),s=n(59645),u=function(e){function t(t){var n=e.call(this)||this;return n._sceneTree=t,n._jsonLoadingEvent=n.disposeVar(new a.Event),n._setJsonProcessing=n.disposeVar((0,s.createProcessingFromAsyncFunc)((function(e,t){return i(n,void 0,void 0,(function(){return c(this,(function(n){switch(n.label){case 0:return this._jsonLoadingEvent.emit({type:"init"}),this._jsonLoadingEvent.emit({type:"loading"}),t?[4,e.promise(this._sceneTree.preloadFunc(t))]:[3,2];case 1:n.sent(),n.label=2;case 2:return this._setJson(t),this._jsonLoadingEvent.emit({type:"loaded"}),[2]}}))}))}))),n._setJsonProcessing.errorFunc=function(e){n._jsonLoadingEvent.emit({type:"error",error:e})},n}return o(t,e),Object.defineProperty(t.prototype,"jsonLoadingEvent",{get:function(){return this._jsonLoadingEvent},enumerable:!1,configurable:!0}),t.prototype._setJson=function(e){try{this._sceneTree.setJson(e||{})}catch(e){console.error("json数据装配时发生错误！error: ".concat(e))}},Object.defineProperty(t.prototype,"json",{get:function(){return this._sceneTree.getJson()},set:function(e){this._setJsonProcessing.restart(new s.CancelError("JSON重新赋值！"),e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"jsonStr",{get:function(){return JSON.stringify(this.json,void 0,"    ")},set:function(e){this.json=JSON.parse(e)},enumerable:!1,configurable:!0}),t}(a.Destroyable);t.SceneTreeJsonLoading=u},26834:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultCreateSceneObject=void 0;var r=n(80468);t.defaultCreateSceneObject=function(e,t){var n=e.type,o=e.id;if(n){var i=r.SceneObject.create(n,o);if(i)return i.json=e,i;console.warn("cannot create sceneObject from type(".concat(n,")"))}else console.warn("cannot create sceneObject from type(".concat(n,")"))}},60305:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultCreateTreeItemDragDrop=void 0;var r=n(4079),o=n(91396);t.defaultCreateTreeItemDragDrop=function(e){if(!(e instanceof r.SceneTreeItem))throw new Error("defaultCreateTreeItemDragDrop !(treeItem instanceof SceneTreeItem)");return new o.SceneTreeItemDragDrop(e)}},98421:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.setSceneObjectShow=t.getSceneObjectShow=void 0,t.getSceneObjectShow=function(e){var t,n,r=!1;do{if(!e)break;"show"in e?r=null===(t=e.show)||void 0===t||t:"enabled"in e&&(r=null===(n=e.enabled)||void 0===n||n)}while(0);return r},t.setSceneObjectShow=function(e,t){e&&("show"in e?e.show=t:"enabled"in e&&(e.enabled=t))}},92436:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),o(n(44876),t),o(n(4079),t),o(n(91396),t),o(n(94882),t),o(n(43370),t)},75373:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function c(e){try{s(r.next(e))}catch(e){i(e)}}function a(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,a)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,c={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return c.label++,{value:i[1],done:!1};case 5:c.label++,r=i[1],i=[0];continue;case 7:i=c.ops.pop(),c.trys.pop();continue;default:if(!((o=(o=c.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){c=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){c.label=i[1];break}if(6===i[0]&&c.label<o[1]){c.label=o[1],o=i;break}if(o&&c.label<o[2]){c.label=o[2],c.ops.push(i);break}o[2]&&c.ops.pop(),c.trys.pop();continue}i=t.call(e,c)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},i=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};Object.defineProperty(t,"__esModule",{value:!0}),t.preload=void 0;var c=n(80468),a=["EnvironmentVariables","ScriptsLoader","SceneScript","ScriptLoader"];t.preload=function(e,t){var n,s;return r(this,void 0,void 0,(function(){var r,u,l,f,p,d,h,b,y,v,g,O,_,j,m;return o(this,(function(o){switch(o.label){case 0:r=function(e){for(var t,n,r=[],o=e.root,c=[void 0===o?{}:o];c.length>0;){var s=c.pop();if(!s)throw new Error("!todo");if(s.children)try{for(var u=(t=void 0,i(s.children)),l=u.next();!l.done;l=u.next()){var f=l.value;if(f.children&&c.unshift(f),f.sceneObj){var p=f.sceneObj.type,d=void 0===p?void 0:p;d||(console.warn("sceneObjJson has no type! treeItem.sceneObj: "),console.warn(f.sceneObj)),d&&a.includes(d)&&r.push(f.sceneObj)}}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}}return r}(e),u=0,l=r.length,o.label=1;case 1:o.trys.push([1,19,20,21]),f=i(r),p=f.next(),o.label=2;case 2:return p.done?[3,18]:(d=p.value,"EnvironmentVariables"!==(h=d).type?[3,3]:(null==(b=c.SceneObject.createFromJson(h))||b.destroy(),[3,16]));case 3:return"ScriptLoader"!==h.type?[3,7]:(y=c.SceneObject.createFromJson(h))?null===(n=y.enabled)||void 0===n||n?[4,y.load()]:[3,5]:[3,6];case 4:o.sent(),o.label=5;case 5:y.destroy(),o.label=6;case 6:return[3,16];case 7:return"ScriptsLoader"!==h.type?[3,11]:(v=c.SceneObject.createFromJson(h))?null===(s=v.enabled)||void 0===s||s?[4,v.load()]:[3,9]:[3,10];case 8:o.sent(),o.label=9;case 9:v.destroy(),o.label=10;case 10:return[3,16];case 11:return"SceneScript"!==h.type?[3,15]:(g=c.SceneObject.createFromJson(h))?g.runOnLoaded&&(O=g.exec())instanceof Promise?[4,O]:[3,13]:[3,14];case 12:o.sent(),o.label=13;case 13:g.destroy(),o.label=14;case 14:return[3,16];case 15:console.warn("preload warn：sceneObjJson.type: ".concat(h.type," cannot be handled!")),o.label=16;case 16:++u,t&&t(u/l,u,l),o.label=17;case 17:return p=f.next(),[3,2];case 18:return[3,21];case 19:return _=o.sent(),j={error:_},[3,21];case 20:try{p&&!p.done&&(m=f.return)&&m.call(f)}finally{if(j)throw j.error}return[7];case 21:return[2]}}))}))}},69359:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.DragStartDataManager=void 0;var i=n(51355),c=function(e){function t(){var t=e.call(this)||this;return t._data=t.disposeVar((0,i.react)(void 0)),t}return o(t,e),Object.defineProperty(t.prototype,"data",{get:function(){return this._data.value},set:function(e){this._data.value=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"dataChanged",{get:function(){return this._data.changed},enumerable:!1,configurable:!0}),t}(i.Destroyable);t.DragStartDataManager=c},94882:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});Object.defineProperty(t,"__esModule",{value:!0}),t.TreeItemDragDrop=void 0;var i=n(51355),c=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._dragStartEvent=t.disposeVar(new i.Event),t._dragOverEvent=t.disposeVar(new i.Event),t._dragLeaveEvent=t.disposeVar(new i.Event),t._dropEvent=t.disposeVar(new i.Event),t}return o(t,e),t.prototype.dragStart=function(e){this._dragStartEvent.emit(e)},t.prototype.dragOver=function(e){this._dragOverEvent.emit(e)},t.prototype.dragLeave=function(e){this._dragLeaveEvent.emit(e)},t.prototype.drop=function(e){this._dropEvent.emit(e)},t}(i.Destroyable);t.TreeItemDragDrop=c},87612:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.moveToTreeItem=t.getReactFuncs=t.canMoveToTreeItem=t.UiTreeObject=t.UiTree=t.TreeItem=t.Tree=void 0;var i=n(59645);Object.defineProperty(t,"Tree",{enumerable:!0,get:function(){return i.Tree}}),Object.defineProperty(t,"TreeItem",{enumerable:!0,get:function(){return i.TreeItem}}),Object.defineProperty(t,"UiTree",{enumerable:!0,get:function(){return i.UiTree}}),Object.defineProperty(t,"UiTreeObject",{enumerable:!0,get:function(){return i.UiTreeObject}}),Object.defineProperty(t,"canMoveToTreeItem",{enumerable:!0,get:function(){return i.canMoveToTreeItem}}),Object.defineProperty(t,"getReactFuncs",{enumerable:!0,get:function(){return i.getReactFuncs}}),Object.defineProperty(t,"moveToTreeItem",{enumerable:!0,get:function(){return i.moveToTreeItem}}),o(n(69359),t),o(n(94882),t)},48980:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||r(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),t.copyright=void 0,(0,n(59645).registerScript)();var i=n(58753);Object.defineProperty(t,"copyright",{enumerable:!0,get:function(){return i.copyright}}),i.copyright.print(),o(n(93753),t),o(n(92436),t),o(n(99085),t),o(n(87612),t)},80468:e=>{e.exports=XE2["xe2-base-objects"]},51355:e=>{e.exports=XE2["xe2-base-utils"]},48269:e=>{e.exports=XE2["xe2-cesium-objects"]},59645:e=>{e.exports=XE2["xe2-utils"]},9675:e=>{e.exports=vtxf["xr-base-utils"]},81901:e=>{e.exports=vtxf["xr-utils"]}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.j=988;var r=n(48980);(XE2=void 0===XE2?{}:XE2).xe2=r})();